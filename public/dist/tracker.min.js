(()=>{"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n=function(e,t,r){var n=e[t];return function(){for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return r.apply(null,o),n.apply(e,o)}},o=function(){var e=window,t=e.doNotTrack,r=e.navigator,n=e.external,o="msTrackingProtectionEnabled",a=t||r.doNotTrack||r.msDoNotTrack||n&&o in n&&n[o]();return"1"==a||"yes"===a},a=function(){var e,t=document.getElementsByTagName("body")[0];return t&&((e=document.createElement("div")).setAttribute("class","ads ad adsbox doubleclick ad-placement carbon-ads"),e.setAttribute("style","height:1px;width:1px;position: absolute;left:-999px;top:-999px;"),e.textContent="&nbsp;",t.appendChild(e)),!!e&&0===e.offsetHeight},i=navigator&&navigator.cookieEnabled||!!document.cookie;function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=function(e,n,o,a,i,l){return function(){var s={name:n,prefix:o,type:a,value:i},f={tagName:e.tagName},p=function(e,n){return n.getAttributeNames().reduce((function(o,a){if(a.startsWith(e)){var i=a.replace(e,"");if(i)return t(t({},o),{},r({},i,n.getAttribute(a)))}return o}),{})}("data-kbs-",e),d=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({class:s,element:f},p),b={sendBeacon:"A"===d.element.tagName};return l(a,d,b)}};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){d(a,n,o,i,c,"next",e)}function c(e){d(a,n,o,i,c,"throw",e)}i(void 0)}))}}!function(e){var t=e.screen,r=e.navigator,c=r.language,u=r.platform,p=e.location,d=e.document,y=e.history,v=d.querySelector("script[data-tracker-id]");if(!v)throw new Error("data-tracker-id not found");var h=v.getAttribute.bind(v),g=h("data-tracker-id"),m=h("data-server-url");if(!m)throw new Error("data-server-url not found");var w=/^kbs-([a-z]+)-([\w]+[\w-]*)$/,O={},j=p.href,S=d.referrer,k=null,P={},A=function(){var e=b(regeneratorRuntime.mark((function e(r,n){var l,s,f,p,d,b=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=b.length>2&&void 0!==b[2]&&b[2],!o()){e.next=3;break}return e.abrupt("return");case 3:if(s="".concat(m,"/collect"),f={tracker_id:g,url:{href:j,referrer:S},event:{type:r,payload:n},device:{platform:u,screen:{width:t.width,height:t.height}},browser:{language:c,adBlock:a(),cookies:i},serverSide:P},!l){e.next=9;break}return p=new Blob([JSON.stringify(f)],{type:"application/json"}),d=navigator.sendBeacon(s,p),e.abrupt("return",d?{status:"success",event_id:"sendBeacon"}:{status:"error",message:"User agent failed to queue the data transfer"});case 9:return e.next=11,fetch(s,{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(f),credentials:"include"}).then((function(e){return e.json()}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=b(regeneratorRuntime.mark((function e(){var t,r,n,o,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"custom",r=a.length>1&&void 0!==a[1]?a[1]:{},n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=5,A(t,r,n.sendBeacon);case 5:return o=e.sent,k&&k(o),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){var t=e.querySelectorAll("[class*='kbs-']");Array.prototype.forEach.call(t,D)},D=function(e){var t,r,n,o=null===(t=e.getAttribute("class"))||void 0===t?void 0:t.split(" ");if(o){var a,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}(o);try{for(i.s();!(a=i.n()).done;){var c=a.value;if(w.test(c)){var u=(r=c.split("-"),n=3,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(r,n)||f(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],p=u[1],d=u[2];O[c]=O[c]||l(e,c,s,p,d,x),e.addEventListener(p,O[c],!0)}}}catch(e){i.e(e)}finally{i.f()}}},N=function(e,t,r){r&&(S=j,(j=p.href)!==S&&x("page-view"))},B={get serverSideData(){return P},set serverSideData(e){"object"===s(e)&&(P=e)},get callback(){return k},set callback(e){return"function"==typeof e&&(k=e),k},trackEvent:x};if(Object.freeze(B),e.kbs||(e.kbs=B),!o()){y.pushState=n(y,"pushState",N),y.replaceState=n(y,"replaceState",N);var T=function(){"complete"===d.readyState&&(x("page-view"),E(d),new MutationObserver((function(e){e.forEach((function(e){var t=e.target;D(t),E(t)}))})).observe(d,{childList:!0,subtree:!0}))};d.addEventListener("readystatechange",T,!0),T()}}(window)})();